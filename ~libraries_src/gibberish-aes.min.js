(function() {/*
 Gibberish-AES 
 A lightweight Javascript Libray for OpenSSL compatible AES CBC encryption.

 Author: Mark Percival
 Email: mark@mpercival.com
 Copyright: Mark Percival - http://mpercival.com 2008

 With thanks to:
 Josh Davis - http://www.josh-davis.org/ecmaScrypt
 Chris Veness - http://www.movable-type.co.uk/scripts/aes.html
 Michel I. Gallant - http://www.jensign.com/
 Jean-Luc Cooke <jlcooke@certainkey.com> 2012-07-12: added strhex + invertArr to compress G2X/G3X/G9X/GBX/GEX/SBox/SBoxInv/Rcon saving over 7KB, and added encString, decString, also made the MD5 routine more easlier compressible using yuicompressor.

 License: MIT

 Usage: GibberishAES.enc("secret", "password")
 Outputs: AES Encrypted text encoded in Base64
*/
(function(t,q){"object"===typeof exports?module.exports=q():"function"===typeof define&&define.amd?define(q):t.GibberishAES=q()})(this,function(){var t=14,q=8,u=!1,L=function(a,d){var b="",c,g;if(d){c=a[15];if(16<c)throw"Decryption error: Maybe bad key";if(16===c)return"";for(g=0;g<16-c;g++)b+=String.fromCharCode(a[g])}else for(g=0;16>g;g++)b+=String.fromCharCode(a[g]);return b},w=function(a,d){var b=[],c;if(!d)try{a=unescape(encodeURIComponent(a))}catch(g){throw"Error on UTF-8 encode";}for(c=0;c<
a.length;c++)b[c]=a.charCodeAt(c);return b},G=function(a,d){var b=12<=t?3:2,c,g=[],n=a.concat(d),m;g[0]=F(n);c=g[0];for(m=1;m<b;m++)g[m]=F(g[m-1].concat(n)),c=c.concat(g[m]);b=c.slice(0,4*q);c=c.slice(4*q,4*q+16);return{key:b,iv:c}},N=function(a,d,b){d=H(d);var c=Math.ceil(a.length/16),g=[],n,m=[];for(n=0;n<c;n++){var l=n,q=a.slice(16*n,16*n+16),r=[],t;16>q.length&&(r=16-q.length,r=[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r]);for(t=0;t<q.length;t++)r[t]=q[t];g[l]=r}0===a.length%16&&g.push([16,16,16,16,16,16,
16,16,16,16,16,16,16,16,16,16]);for(n=0;n<g.length;n++)g[n]=0===n?x(g[n],b):x(g[n],m[n-1]),m[n]=M(g[n],d);return m},P=function(a,d,b,c){d=H(d);var g=a.length/16,n=[],m,l=[],q="";for(m=0;m<g;m++)n.push(a.slice(16*m,16*(m+1)));for(m=n.length-1;0<=m;m--)l[m]=O(n[m],d),l[m]=0===m?x(l[m],b):x(l[m],n[m-1]);for(m=0;m<g-1;m++)q+=L(l[m],!1);var q=q+L(l[m],!0),r;if(c)r=q;else try{r=decodeURIComponent(escape(q))}catch(W){throw"Bad Key";}return r},M=function(a,d){u=!1;var b=y(a,d,0),c;for(c=1;c<t+1;c++)b=Q(b),
b=R(b),c<t&&(b=S(b)),b=y(b,d,c);return b},O=function(a,d){u=!0;var b=y(a,d,t),c;for(c=t-1;-1<c;c--)b=R(b),b=Q(b),b=y(b,d,c),0<c&&(b=S(b));return b},Q=function(a){var d=u?U:I,b=[],c;for(c=0;16>c;c++)b[c]=d[a[c]];return b},R=function(a){var d=[],b=u?[0,13,10,7,4,1,14,11,8,5,2,15,12,9,6,3]:[0,5,10,15,4,9,14,3,8,13,2,7,12,1,6,11],c;for(c=0;16>c;c++)d[c]=a[b[c]];return d},S=function(a){var d=[],b;if(u)for(b=0;4>b;b++)d[4*b]=z[a[4*b]]^A[a[1+4*b]]^B[a[2+4*b]]^C[a[3+4*b]],d[1+4*b]=C[a[4*b]]^z[a[1+4*b]]^A[a[2+
4*b]]^B[a[3+4*b]],d[2+4*b]=B[a[4*b]]^C[a[1+4*b]]^z[a[2+4*b]]^A[a[3+4*b]],d[3+4*b]=A[a[4*b]]^B[a[1+4*b]]^C[a[2+4*b]]^z[a[3+4*b]];else for(b=0;4>b;b++)d[4*b]=D[a[4*b]]^E[a[1+4*b]]^a[2+4*b]^a[3+4*b],d[1+4*b]=a[4*b]^D[a[1+4*b]]^E[a[2+4*b]]^a[3+4*b],d[2+4*b]=a[4*b]^a[1+4*b]^D[a[2+4*b]]^E[a[3+4*b]],d[3+4*b]=E[a[4*b]]^a[1+4*b]^a[2+4*b]^D[a[3+4*b]];return d},y=function(a,d,b){var c=[],g;for(g=0;16>g;g++)c[g]=a[g]^d[b][g];return c},x=function(a,d){var b=[],c;for(c=0;16>c;c++)b[c]=a[c]^d[c];return b},H=function(a){var d=
[],b=[],c,g,n=[];for(c=0;c<q;c++)g=[a[4*c],a[4*c+1],a[4*c+2],a[4*c+3]],d[c]=g;for(c=q;c<4*(t+1);c++){d[c]=[];for(a=0;4>a;a++)b[a]=d[c-1][a];if(0===c%q){a=b[0];for(g=0;3>g;g++)b[g]=b[g+1];b[3]=a;b=T(b);b[0]^=V[c/q-1]}else 6<q&&4===c%q&&(b=T(b));for(a=0;4>a;a++)d[c][a]=d[c-q][a]^b[a]}for(c=0;c<t+1;c++)for(n[c]=[],b=0;4>b;b++)n[c].push(d[4*c+b][0],d[4*c+b][1],d[4*c+b][2],d[4*c+b][3]);return n},T=function(a){for(var d=0;4>d;d++)a[d]=I[a[d]];return a},J=function(a,d){var b,c=[];for(b=0;b<a.length;b+=d)c[b/
d]=parseInt(a.substr(b,d),16);return c},v=function(a){var d,b=[];for(d=0;256>d;d++){var c=d,g=a,n=d,m,l;for(m=l=0;8>m;m++)l=1===(n&1)?l^g:l,g=127<g?283^g<<1:g<<1,n>>>=1;b[c]=l}return b},I=J("637c777bf26b6fc53001672bfed7ab76ca82c97dfa5947f0add4a2af9ca472c0b7fd9326363ff7cc34a5e5f171d8311504c723c31896059a071280e2eb27b27509832c1a1b6e5aa0523bd6b329e32f8453d100ed20fcb15b6acbbe394a4c58cfd0efaafb434d338545f9027f503c9fa851a3408f929d38f5bcb6da2110fff3d2cd0c13ec5f974417c4a77e3d645d197360814fdc222a908846eeb814de5e0bdbe0323a0a4906245cc2d3ac629195e479e7c8376d8dd54ea96c56f4ea657aae08ba78252e1ca6b4c6e8dd741f4bbd8b8a703eb5664803f60e613557b986c11d9ee1f8981169d98e949b1e87e9ce5528df8ca1890dbfe6426841992d0fb054bb16",
2),U=function(a){var d,b=[];for(d=0;d<a.length;d++)b[a[d]]=d;return b}(I),V=J("01020408102040801b366cd8ab4d9a2f5ebc63c697356ad4b37dfaefc591",2),D=v(2),E=v(3),C=v(9),A=v(11),B=v(13),z=v(14),F=function(a){function d(a,b){var c,d,g,e,f;g=a&2147483648;e=b&2147483648;c=a&1073741824;d=b&1073741824;f=(a&1073741823)+(b&1073741823);return c&d?f^2147483648^g^e:c|d?f&1073741824?f^3221225472^g^e:f^1073741824^g^e:f^g^e}function b(a,b,c,g,f,e,h){a=d(a,d(d(b&c|~b&g,f),h));return d(a<<e|a>>>32-e,b)}function c(a,
b,c,g,e,f,h){a=d(a,d(d(b&g|c&~g,e),h));return d(a<<f|a>>>32-f,b)}function g(a,b,c,g,f,e,h){a=d(a,d(d(b^c^g,f),h));return d(a<<e|a>>>32-e,b)}function n(a,b,c,g,e,f,h){a=d(a,d(d(c^(b|~g),e),h));return d(a<<f|a>>>32-f,b)}function m(a){var b,c,d=[];for(c=0;3>=c;c++)b=a>>>8*c&255,d=d.concat(b);return d}var l=[],q,r,t,u,e,f,h,k,p=J("67452301efcdab8998badcfe10325476d76aa478e8c7b756242070dbc1bdceeef57c0faf4787c62aa8304613fd469501698098d88b44f7afffff5bb1895cd7be6b901122fd987193a679438e49b40821f61e2562c040b340265e5a51e9b6c7aad62f105d02441453d8a1e681e7d3fbc821e1cde6c33707d6f4d50d87455a14eda9e3e905fcefa3f8676f02d98d2a4c8afffa39428771f6816d9d6122fde5380ca4beea444bdecfa9f6bb4b60bebfbc70289b7ec6eaa127fad4ef308504881d05d9d4d039e6db99e51fa27cf8c4ac5665f4292244432aff97ab9423a7fc93a039655b59c38f0ccc92ffeff47d85845dd16fa87e4ffe2ce6e0a30143144e0811a1f7537e82bd3af2352ad7d2bbeb86d391",
8),l=function(a){var b,c=a.length;b=c+8;for(var d=16*((b-b%64)/64+1),g=[],f,e=0;e<c;)b=(e-e%4)/4,f=e%4*8,g[b]|=a[e]<<f,e++;b=(e-e%4)/4;g[b]|=128<<e%4*8;g[d-2]=c<<3;g[d-1]=c>>>29;return g}(a);e=p[0];f=p[1];h=p[2];k=p[3];for(a=0;a<l.length;a+=16)q=e,r=f,t=h,u=k,e=b(e,f,h,k,l[a+0],7,p[4]),k=b(k,e,f,h,l[a+1],12,p[5]),h=b(h,k,e,f,l[a+2],17,p[6]),f=b(f,h,k,e,l[a+3],22,p[7]),e=b(e,f,h,k,l[a+4],7,p[8]),k=b(k,e,f,h,l[a+5],12,p[9]),h=b(h,k,e,f,l[a+6],17,p[10]),f=b(f,h,k,e,l[a+7],22,p[11]),e=b(e,f,h,k,l[a+8],
7,p[12]),k=b(k,e,f,h,l[a+9],12,p[13]),h=b(h,k,e,f,l[a+10],17,p[14]),f=b(f,h,k,e,l[a+11],22,p[15]),e=b(e,f,h,k,l[a+12],7,p[16]),k=b(k,e,f,h,l[a+13],12,p[17]),h=b(h,k,e,f,l[a+14],17,p[18]),f=b(f,h,k,e,l[a+15],22,p[19]),e=c(e,f,h,k,l[a+1],5,p[20]),k=c(k,e,f,h,l[a+6],9,p[21]),h=c(h,k,e,f,l[a+11],14,p[22]),f=c(f,h,k,e,l[a+0],20,p[23]),e=c(e,f,h,k,l[a+5],5,p[24]),k=c(k,e,f,h,l[a+10],9,p[25]),h=c(h,k,e,f,l[a+15],14,p[26]),f=c(f,h,k,e,l[a+4],20,p[27]),e=c(e,f,h,k,l[a+9],5,p[28]),k=c(k,e,f,h,l[a+14],9,p[29]),
h=c(h,k,e,f,l[a+3],14,p[30]),f=c(f,h,k,e,l[a+8],20,p[31]),e=c(e,f,h,k,l[a+13],5,p[32]),k=c(k,e,f,h,l[a+2],9,p[33]),h=c(h,k,e,f,l[a+7],14,p[34]),f=c(f,h,k,e,l[a+12],20,p[35]),e=g(e,f,h,k,l[a+5],4,p[36]),k=g(k,e,f,h,l[a+8],11,p[37]),h=g(h,k,e,f,l[a+11],16,p[38]),f=g(f,h,k,e,l[a+14],23,p[39]),e=g(e,f,h,k,l[a+1],4,p[40]),k=g(k,e,f,h,l[a+4],11,p[41]),h=g(h,k,e,f,l[a+7],16,p[42]),f=g(f,h,k,e,l[a+10],23,p[43]),e=g(e,f,h,k,l[a+13],4,p[44]),k=g(k,e,f,h,l[a+0],11,p[45]),h=g(h,k,e,f,l[a+3],16,p[46]),f=g(f,h,
k,e,l[a+6],23,p[47]),e=g(e,f,h,k,l[a+9],4,p[48]),k=g(k,e,f,h,l[a+12],11,p[49]),h=g(h,k,e,f,l[a+15],16,p[50]),f=g(f,h,k,e,l[a+2],23,p[51]),e=n(e,f,h,k,l[a+0],6,p[52]),k=n(k,e,f,h,l[a+7],10,p[53]),h=n(h,k,e,f,l[a+14],15,p[54]),f=n(f,h,k,e,l[a+5],21,p[55]),e=n(e,f,h,k,l[a+12],6,p[56]),k=n(k,e,f,h,l[a+3],10,p[57]),h=n(h,k,e,f,l[a+10],15,p[58]),f=n(f,h,k,e,l[a+1],21,p[59]),e=n(e,f,h,k,l[a+8],6,p[60]),k=n(k,e,f,h,l[a+15],10,p[61]),h=n(h,k,e,f,l[a+6],15,p[62]),f=n(f,h,k,e,l[a+13],21,p[63]),e=n(e,f,h,k,l[a+
4],6,p[64]),k=n(k,e,f,h,l[a+11],10,p[65]),h=n(h,k,e,f,l[a+2],15,p[66]),f=n(f,h,k,e,l[a+9],21,p[67]),e=d(e,q),f=d(f,r),h=d(h,t),k=d(k,u);return m(e).concat(m(f),m(h),m(k))},K=function(){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=a.split("");"function"===typeof Array.indexOf&&(a=d);return{encode:function(a,c){var b=[],n="",m;for(m=0;m<16*a.length;m++)b.push(a[Math.floor(m/16)][m%16]);for(m=0;m<b.length;m+=3)n+=d[b[m]>>2],n+=d[(b[m]&3)<<4|b[m+1]>>4],n=void 0!==b[m+1]?
n+d[(b[m+1]&15)<<2|b[m+2]>>6]:n+"=",n=void 0!==b[m+2]?n+d[b[m+2]&63]:n+"=";b=n.slice(0,64)+"\n";for(m=1;m<Math.ceil(n.length/64);m++)b+=n.slice(64*m,64*m+64)+(Math.ceil(n.length/64)===m+1?"":"\n");return b},decode:function(b){b=b.replace(/\n/g,"");var c=[],d=[],n=[],m;for(m=0;m<b.length;m+=4)d[0]=a.indexOf(b.charAt(m)),d[1]=a.indexOf(b.charAt(m+1)),d[2]=a.indexOf(b.charAt(m+2)),d[3]=a.indexOf(b.charAt(m+3)),n[0]=d[0]<<2|d[1]>>4,n[1]=(d[1]&15)<<4|d[2]>>2,n[2]=(d[2]&3)<<6|d[3],c.push(n[0],n[1],n[2]);
return c=c.slice(0,c.length-c.length%16)}}}();return{size:function(a){switch(a){case 128:t=10;q=4;break;case 192:t=12;q=6;break;case 256:t=14;q=8;break;default:throw"Invalid Key Size Specified:"+a;}},h2a:function(a){var d=[];a.replace(/(..)/g,function(a){d.push(parseInt(a,16))});return d},expandKey:H,encryptBlock:M,decryptBlock:O,Decrypt:u,s2a:w,rawEncrypt:N,rawDecrypt:P,dec:function(a,d,b){a=K.decode(a);var c=a.slice(8,16),c=G(w(d,b),c);d=c.key;c=c.iv;a=a.slice(16,a.length);return a=P(a,d,c,b)},
openSSLKey:G,a2h:function(a){var d="",b;for(b=0;b<a.length;b++)d+=(16>a[b]?"0":"")+a[b].toString(16);return d},enc:function(a,d,b){var c;c=[];var g;for(g=0;8>g;g++)c=c.concat(Math.floor(256*Math.random()));g=G(w(d,b),c);d=g.key;g=g.iv;c=[[83,97,108,116,101,100,95,95].concat(c)];a=w(a,b);a=N(a,d,g);a=c.concat(a);return K.encode(a)},Hash:{MD5:F},Base64:K}});
})();

